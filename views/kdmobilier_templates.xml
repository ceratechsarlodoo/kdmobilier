<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <!-- WEB SALE PRODUCTS -->
  <template
    id="custom_products"
    inherit_id="website_sale.products"
    name="Custom Products"
  >
    <xpath expr="//div[@id='wrap']" position="replace">
      <div id="wrap" class="js_sale o_wsale_products_page">
        <div
          class="oe_structure page-content oe_empty oe_structure_not_nearest"
          id="oe_structure_website_sale_products_1"
        />
        <div class="container-fluid px-4 oe_website_sale pt-2">
          <div
            class="row pbmit-element-posts-wrapper o_wsale_products_main_row align-items-start flex-nowrap"
          >
            <aside
              t-if="hasLeftColumn"
              id="products_grid_before"
              t-attf-class="sidebar position-sticky clearfix #{category and not category.child_id and attributes  and  'd-none d-lg-block col-2' or 'd-none'}"
            >
              <aside class="widget widget-categories">
                <span t-esc="opt_wsale_categories" />

                <div
                  class="o_wsale_products_grid_before_rail vh-100 ms-n2 mt-n2 pt-2 pe-lg-2 pb-lg-5 ps-2 overflow-y-scroll"
                >
                  <div
                    t-if="opt_wsale_categories"
                    class="products_categories mb-3"
                  >
                    <t t-call="website_sale.products_categories_list" />
                  </div>
                  <div class="products_attributes_filters" />
                  <t
                    t-if="opt_wsale_filter_price and opt_wsale_attributes"
                    t-call="website_sale.filter_products_price"
                  />
                </div>
              </aside>
            </aside>
            <div
              id="products_grid"
              t-attf-class="#{'o_wsale_layout_list' if layout_mode == 'list' else ''} #{category and not category.child_id and attributes and 'col-lg-10' or 'col-12'}"
            >
              <t t-call="theme_kdmobilier.custom_products_breadcrumb">
                <t
                  t-set="_classes"
                  t-valuef="d-none d-lg-flex w-100 p-0 small"
                />
              </t>
              <div
                class="products_header btn-toolbar flex-nowrap align-items-center justify-content-between gap-3"
              >
                <t
                  t-if="opt_wsale_categories_top"
                  t-call="theme_kdmobilier.custom_filmstrip_categories"
                />
                <!-- <t
                  t-if="is_view_active('website_sale.search')"
                  t-call="website_sale.search"
                >
                  <t t-set="search" t-value="original_search or search" />
                  <t
                    t-set="_form_classes"
                    t-valuef="d-lg-inline {{'d-inline' if not category else 'd-none'}}"
                  />
                </t> -->

                <t t-call="website_sale.pricelist_list" t-cache="pricelist">
                  <t t-set="_classes" t-valuef="d-none d-lg-inline" />
                </t>

                <!-- <t
                  t-if="is_view_active('website_sale.sort')"
                  t-call="website_sale.sort"
                >
                  <t t-set="_classes" t-valuef="d-none d-lg-inline-block" />
                </t> -->

                <div
                  t-if="category"
                  class="d-flex align-items-center d-lg-none me-auto"
                >
                  <t
                    t-if="not category.parent_id"
                    t-set="backUrl"
                    t-valuef="/shop"
                  />
                  <t
                    t-else=""
                    t-set="backUrl"
                    t-value="keep('/shop/category/' + slug(category.parent_id), category=0)"
                  />

                  <a
                    t-attf-class="btn btn-{{ navClass }} me-2"
                    t-att-href="category.parent_id and keep('/shop/category/' + slug(category.parent_id), category=0) or '/shop'"
                  >
                    <i class="fa fa-angle-left" />
                  </a>
                  <h4 t-out="category.name" class="mb-0 me-auto" />
                </div>

                <!-- <t
                  t-if="is_view_active('website_sale.add_grid_or_list_option')"
                  t-call="website_sale.add_grid_or_list_option"
                >
                  <t t-set="_classes" t-valuef="d-flex" />
                </t>

                <button
                  t-if="is_view_active('website_sale.sort') or opt_wsale_categories or opt_wsale_attributes or opt_wsale_attributes_top"
                  t-attf-class="btn btn-{{
                    navClass
                  }} position-relative {{not opt_wsale_attributes_top and 'd-lg-none'}}"
                  data-bs-toggle="offcanvas"
                  data-bs-target="#o_wsale_offcanvas"
                >
                  <i class="fa fa-sliders" />
                  <span
                    t-if="isFilteringByPrice or attrib_set or tags"
                    t-attf-class="position-absolute top-0 start-100 translate-middle border border-{{
                      navClass
                    }} rounded-circle bg-danger p-1"
                    ><span class="visually-hidden">filters active</span></span
                  >
                </button> -->
              </div>

              <div
                t-if="original_search and products"
                class="alert alert-warning mt8"
              >
                No results found for '<span t-esc="original_search" />'. Showing
                results for '<span t-esc="search" />'.
              </div>

              <t t-if="category">
                <t t-set="editor_msg"
                  >Drag building blocks here to customize the header for "<t
                    t-esc="category.name"
                  />" category.</t
                >
                <div
                  class="mb16"
                  id="category_header"
                  t-att-data-editor-message="editor_msg"
                  t-field="category.website_description"
                />
              </t>
              <!-- PRODUCT LIST -->
              <div t-if="products" class="row">
                <t t-foreach="bins" t-as="tr_product">
                  <t t-foreach="tr_product" t-as="td_product">
                    <t t-if="td_product">
                      <article
                        class="pbmit-ele-blog pbmit-blog-style-1 col-md-6 col-lg-3"
                      >
                        <div class="post-item">
                          <div class="pbminfotech-box-content">
                            <t t-call="website_sale.products_item">
                              <t
                                t-set="product"
                                t-value="td_product['product']"
                              />
                            </t>
                          </div>
                        </div>
                      </article>
                    </t>
                  </t>
                </t>
              </div>
              <!-- PRODUCT LIST -->
              <div
                t-nocache="get the actual search"
                t-else=""
                class="text-center text-muted mt128 mb256"
              >
                <t t-if="not search">
                  <h3 class="mt8">No product defined</h3>
                  <p t-if="category">No product defined in this category.</p>
                </t>
                <t t-else="">
                  <h3 class="mt8">No results</h3>
                  <p>
                    No results for "<strong t-esc="search" />"<t
                      t-if="category"
                    >
                      in category "<strong t-esc="category.display_name" />"</t
                    >.
                  </p>
                </t>
                <p t-ignore="true" groups="sales_team.group_sale_manager">
                  Click <i>'New'</i> in the top-right corner to create your
                  first product.
                </p>
              </div>
              <div
                class="products_pager d-flex justify-content-center pt-5 pb-3"
              >
                <t t-call="website.pager" />
              </div>
            </div>
          </div>

          <t t-call="website_sale.o_wsale_offcanvas" />
        </div>
        <div
          class="oe_structure oe_empty oe_structure_not_nearest"
          id="oe_structure_website_sale_products_2"
        />
      </div>
    </xpath>
  </template>
  <!-- WEB SALE PRODUCTS -->

  <!-- RELATED TO THE WEB SALE PRODUCTS -->
  <template
    id="products_attributes"
    inherit_id="theme_kdmobilier.custom_products"
    active="True"
    name="Attributes &amp; Variants filters"
  >
    <xpath
      expr="//div[hasclass('products_attributes_filters')]"
      position="inside"
    >
      <t t-if="category and not category.child_id">
        <div id="wsale_products_attributes_collapse" class="position-relative">
          <form
            t-if="attributes or all_tags"
            class="js_attributes position-relative mb-2"
            method="get"
          >
            <input
              t-if="category"
              type="hidden"
              name="category"
              t-att-value="category.id"
            />
            <input type="hidden" name="search" t-att-value="search" />
            <input type="hidden" name="order" t-att-value="order" />
            <a
              t-if="attrib_values or tags"
              t-att-href="keep('/shop'+ ('/category/'+slug(category)) if category else None, attrib=0, tags=0)"
              t-attf-class="btn btn-{{
                navClass
              }} d-flex align-items-center py-1 mb-2"
            >
              <small class="mx-auto"><b>Clear Filters</b></small>
              <i class="oi oi-close" />
            </a>
            <t t-foreach="attributes" t-as="a">
              <t t-cache="a,attrib_set">
                <div
                  class="accordion-item nav-item mb-1 border-0"
                  t-if="a.value_ids and len(a.value_ids) &gt; 1"
                >
                  <h6 class="mb-3">
                    <b
                      class="o_products_attributes_title d-none d-lg-block"
                      t-field="a.name"
                    />
                  </h6>
                  <div t-attf-id="o_products_attributes_{{ a.id }}" class="">
                    <t t-if="a.display_type == 'select'">
                      <select
                        class="form-select css_attribute_select mb-2"
                        name="attrib"
                      >
                        <option value="" selected="true">-</option>
                        <t t-foreach="a.value_ids" t-as="v">
                          <option
                            t-att-value="'%s-%s' % (a.id,v.id)"
                            t-esc="v.name"
                            t-att-selected="v.id in attrib_set"
                          />
                        </t>
                      </select>
                    </t>
                    <div t-elif="a.display_type == 'color'" class="mb-3">
                      <t
                        t-call="website_sale.o_wsale_offcanvas_color_attribute"
                      />
                    </div>
                    <div
                      t-elif="a.display_type in ('radio', 'pills', 'multi')"
                      class="flex-column mb-3"
                    >
                      <t t-foreach="a.value_ids" t-as="v">
                        <div class="form-check mb-1">
                          <input
                            type="checkbox"
                            name="attrib"
                            class="form-check-input"
                            t-att-id="'%s-%s' % (a.id,v.id)"
                            t-att-value="'%s-%s' % (a.id,v.id)"
                            t-att-checked="'checked' if v.id in attrib_set else None"
                          />
                          <label
                            class="form-check-label fw-normal"
                            t-att-for="'%s-%s' % (a.id,v.id)"
                            t-field="v.name"
                          />
                        </div>
                      </t>
                    </div>
                  </div>
                </div>
              </t>
            </t>
            <t
              t-if="opt_wsale_filter_tags and opt_wsale_attributes"
              t-call="website_sale.filter_products_tags"
            >
              <t t-set="all_tags" t-value="all_tags" />
            </t>
          </form>
        </div>
      </t>
    </xpath>
  </template>
  <!-- RELATED TO THE WEB SALE PRODUCTS -->

  <!-- PRODUCTS BREADCRUMB TOP LINKS ON THE CATEGORY -->
  <template
    id="custom_products_breadcrumb"
    name="Custom Products Breadcrumb"
    inherit_id="website_sale.products_breadcrumb"
  >
    <xpath
      expr="//ol[@t-attf-class='breadcrumb #{_classes}']"
      position="replace"
    >
      <ol t-if="category" t-attf-class="breadcrumb #{_classes}">
        <li class="breadcrumb-item">
          <a class="fw-normal" href="/shop">Products</a>
        </li>
        <t t-foreach="category.parents_and_self" t-as="cat">
          <li t-if="cat == category" class="breadcrumb-item">
            <span class="d-inline-block" t-field="cat.name" />
          </li>
          <li t-else="" class="breadcrumb-item">
            <a
              class="fw-normal"
              t-att-href="keep('/shop/category/%s' % slug(cat), category=0)"
              t-field="cat.name"
            />
          </li>
        </t>
      </ol>
    </xpath>
  </template>
  <!-- PRODUCTS BREADCRUMB TOP LINKS ON THE CATEGORY -->

  <!-- PRODUCT ITEM CUSTOM -->
  <template
    id="products_item_blog_style"
    inherit_id="website_sale.products_item"
    name="Product Item Blog Style"
  >
    <xpath expr="//form" position="replace">
      <form
        action="/shop/cart/update"
        method="post"
        class="oe_product_cart h-100 d-flex pbminfotech-box-content"
        t-att-data-publish="product.website_published and 'on' or 'off'"
        itemscope="itemscope"
        itemtype="http://schema.org/Product"
      >
        <t
          t-set="product_href"
          t-value="keep(product.website_url, page=(pager['page']['num'] if pager['page']['num']&gt;1 else None))"
        />
        <t
          t-set="image_type"
          t-value="product._get_suitable_image_size(ppr, td_product['x'], td_product['y'])"
        />

        <div
          class="oe_product_image position-relative h-100 flex-grow-0 overflow-hidden pbmit-featured-container"
        >
          <input
            type="hidden"
            name="csrf_token"
            t-att-value="request.csrf_token()"
            t-nocache="The csrf token must always be up to date."
          />
          <a
            t-att-href="product_href"
            class="oe_product_image_link d-block h-100 position-relative pbmit-featured-img-wrapper"
            itemprop="url"
            contenteditable="false"
          >
            <t t-set="image_holder" t-value="product._get_image_holder()" />
            <span
              t-field="image_holder.image_1920"
              t-options="{'widget': 'image', 'preview_image': image_type, 'itemprop': 'image', 'class': 'h-100 w-100 position-absolute'}"
              class="oe_product_image_img_wrapper d-flex h-100 justify-content-center align-items-center position-absolute pbmit-featured-wrapper"
            />

            <a class="pbmit-link" t-att-href="product_href"></a>
            <t
              t-set="bg_color"
              t-value="td_product['ribbon']['bg_color'] or ''"
            />
            <t
              t-set="text_color"
              t-value="td_product['ribbon']['text_color']"
            />
            <t t-set="bg_class" t-value="td_product['ribbon']['html_class']" />
            <span
              t-attf-class="o_ribbon o_not_editable #{bg_class}"
              t-attf-style="#{text_color and ('color: %s; ' % text_color)}#{bg_color and 'background-color:' + bg_color}"
              t-out="td_product['ribbon']['html'] or ''"
            />
          </a>
        </div>
        <div
          class="o_wsale_product_information position-relative d-flex flex-column flex-grow-1 flex-shrink-1"
        >
          <div class="o_wsale_product_information_text flex-grow-1">
            <h6 class="o_wsale_products_item_title mb-2">
              <a
                class="text-primary text-decoration-none"
                itemprop="name"
                t-att-href="product_href"
                t-att-content="product.name"
                t-field="product.name"
              />
              <a
                t-if="not product.website_published"
                role="button"
                t-att-href="product_href"
                class="btn btn-sm btn-danger"
                title="This product is unpublished."
              >
                Unpublished
              </a>
            </h6>
          </div>
          <div
            class="o_wsale_product_sub d-flex justify-content-between align-items-end gap-2 flex-wrap pb-1"
          >
            <t
              t-set="template_price_vals"
              t-value="get_product_prices(product)"
            />
            <div class="o_wsale_product_btn" />
            <div
              class="product_price"
              itemprop="offers"
              itemscope="itemscope"
              itemtype="http://schema.org/Offer"
            >
              <t
                t-if="'base_price' in template_price_vals and (template_price_vals['base_price'] &gt; template_price_vals['price_reduce']) and (template_price_vals['price_reduce'] or not website.prevent_zero_price_sale)"
              >
                <del
                  t-attf-class="text-muted me-1 h6 mb-0"
                  style="white-space: nowrap"
                >
                  <em
                    class="small"
                    t-esc="template_price_vals['base_price']"
                    t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"
                  />
                </del>
              </t>
              <span
                class="h6 mb-0"
                t-if="template_price_vals['price_reduce'] or not website.prevent_zero_price_sale"
                t-esc="template_price_vals['price_reduce']"
                t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"
              />
              <span
                class="h6 mb-0"
                t-elif="any(ptav.price_extra for ptav in product.attribute_line_ids.product_template_value_ids)"
                >&amp;nbsp;</span
              >
              <span
                class="h6 mb-0"
                t-else=""
                t-field="website.prevent_zero_price_sale_text"
              />
              <span
                itemprop="price"
                style="display: none"
                t-esc="template_price_vals['price_reduce']"
              />
              <span
                itemprop="priceCurrency"
                style="display: none"
                t-esc="website.currency_id.name"
              />
            </div>
          </div>
        </div>
      </form>
    </xpath>
  </template>
  <!-- PRODUCT ITEM CUSTOM -->

  <!-- TOP NAV CUSTOM CATEGORIES  -->
  <template
    id="custom_filmstrip_categories"
    name="Custom Filmstrip Categories"
    inherit_id="website_sale.filmstrip_categories"
  >
    <xpath
      expr="//div[@class='o_wsale_filmstip_container d-flex align-items-stretch mb-2 overflow-hidden']"
      position="replace"
    >
      <div
        t-if="entries"
        class="o_wsale_filmstip_container d-flex align-items-stretch overflow-hidden"
        style="min-height: 120px"
      >
        <div class="o_wsale_filmstip_wrapper overflow-auto">
          <ul
            class="o_wsale_filmstip d-flex align-items-stretch p-0 mb-0 list-unstyled overflow-visible"
            style="gap: 1rem"
          >
            <t
              t-foreach="entries"
              t-as="c"
              t-if="c.image_128"
              t-set="atLeastOneImage"
              t-value="True"
            />
            <t
              t-if="category.parent_id"
              t-set="backUrl"
              t-value="keep('/shop/category/' + slug(category.parent_id), category=0)"
            />
            <t t-else="" t-set="backUrl" t-value="'/shop'" />

            <li
              t-foreach="entries"
              t-as="c"
              t-attf-class="d-flex {{'pe-4' if not c_last else ''}}"
              t-att-data-link-href="keep('/shop/category/' + slug(c), category=0)"
            >
              <input
                type="radio"
                t-attf-name="wsale_categories_top_radios_{{ parentCategoryId }}"
                class="btn-check pe-none"
                t-att-id="c.id"
                t-att-value="c.id"
                t-att-checked="'true' if c.id == category.id else None"
              />
              <div
                t-attf-class="btn btn-{{
                  navClass
                }} d-flex align-items-center {{'ps-3 pe-4' if c.image_128 else 'px-5'}} fs-5 fw-normal {{ 'border border-2 border-primary' if c.id == category.id else '' }}"
                t-att-for="c.id"
                style="min-height: 80px"
              >
                <div
                  t-if="c.image_128"
                  t-attf-style="
                background-image:url('data:image/png;base64,#{c.image_128}');
                width: 64px;
                height: 64px; 
              "
                  class="o_image_64_cover oe_img_bg o_bg_img_center rounded-3 me-3"
                  t-att-alt="c.name"
                />
                <span t-field="c.name" class="fs-5" />
                <!-- Increased font size -->
              </div>
            </li>
          </ul>
        </div>
      </div>
    </xpath>
  </template>
  <!-- TOP NAV CUSTOM CATEGORIES  -->

  <!-- PRODUCT PAGE CUSTOM -->
  <template
    id="custom_product"
    name="Custom Product"
    inherit_id="website_sale.product"
  >
    <xpath expr="//div[@id='wrap']" position="replace">
      <div
        itemscope="itemscope"
        itemtype="http://schema.org/Product"
        id="wrap"
        class="js_sale o_wsale_product_page"
      >
        <div
          class="oe_structure oe_empty oe_structure_not_nearest"
          id="oe_structure_website_sale_product_1"
          data-editor-message="DROP BUILDING BLOCKS HERE TO MAKE THEM AVAILABLE ACROSS ALL PRODUCTS"
        />
        <section
          id="product_detail"
          t-attf-class="container py-4 oe_website_sale #{'discount' if combination_info['has_discounted_price'] else ''}"
          t-att-data-view-track="view_track and '1' or '0'"
          t-att-data-product-tracking-info="'product_tracking_info' in combination_info and json.dumps(combination_info['product_tracking_info'])"
        >
          <div class="row align-items-center">
            <!-- <div class="col-lg-6 d-flex align-items-center">
              <div class="d-flex justify-content-between w-100">
                <t
                  t-if="is_view_active('website_sale.search')"
                  t-call="website_sale.search"
                >
                  <t t-set="search" t-value="False" />
                  <t t-set="_form_classes" t-valuef="mb-2 mb-lg-0" />
                  <t t-set="_classes" t-value="'me-sm-2'" />
                </t>
                <t
                  t-set="website_sale_pricelists"
                  t-value="website.get_pricelist_available(show_visible=True)"
                />
                <t
                  t-set="hasPricelistDropdown"
                  t-value="website_sale_pricelists and len(website_sale_pricelists)&gt;1"
                />
                <t t-call="website_sale.pricelist_list">
                  <t t-set="_classes" t-valuef="d-lg-inline ms-2" />
                </t>
              </div>
            </div> -->
            <div class="col-lg-6 d-flex align-items-center">
              <ol class="breadcrumb p-0 mb-2 m-lg-0">
                <li class="breadcrumb-item o_not_editable">
                  <a t-att-href="keep(category=0)">All Products</a>
                </li>
                <li
                  t-nocache="The category does not have to be cached, as the product can be accessed via different paths."
                  t-if="category"
                  class="breadcrumb-item"
                >
                  <a
                    t-att-href="keep('/shop/category/%s' % slug(category), category=0)"
                    t-field="category.name"
                  />
                </li>
                <li class="breadcrumb-item active">
                  <span t-field="product.name" />
                </li>
              </ol>
            </div>
          </div>
          <div
            class="row"
            id="product_detail_main"
            data-name="Product Page"
            t-att-data-image_width="website.product_page_image_width"
            t-att-data-image_layout="website.product_page_image_layout"
          >
            <t
              t-set="image_cols"
              t-value="website._get_product_page_proportions()"
            />
            <div
              t-attf-class="col-lg-#{image_cols[0]} mt-lg-4 o_wsale_product_images position-relative"
              t-if="website.product_page_image_width != 'none'"
            >
              <t t-call="website_sale.shop_product_images" />
            </div>
            <div
              t-attf-class="col-lg-#{image_cols[1]} mt-md-4"
              id="product_details"
            >
              <t t-set="base_url" t-value="product.get_base_url()" />
              <h1 itemprop="name" t-field="product.name">Product Name</h1>
              <span
                itemprop="url"
                style="display: none"
                t-esc="base_url + product.website_url"
              />
              <span
                itemprop="image"
                style="display: none"
                t-esc="base_url + website.image_url(product, 'image_1920')"
              />
              <t t-if="is_view_active('website_sale.product_comment')">
                <a
                  href="#o_product_page_reviews"
                  class="o_product_page_reviews_link text-decoration-none"
                >
                  <t t-call="portal_rating.rating_widget_stars_static">
                    <t t-set="rating_avg" t-value="product.rating_avg" />
                    <t t-set="trans_text_plural">%s reviews</t>
                    <t t-set="trans_text_singular">%s review</t>
                    <t
                      t-set="rating_count"
                      t-value="(trans_text_plural if product.rating_count > 1 else trans_text_singular) % product.rating_count"
                    />
                  </t>
                </a>
              </t>
              <p
                t-field="product.description_sale"
                class="text-muted my-2"
                placeholder="A short description that will also appear on documents."
              />
              <div
                t-field="product.description_ecommerce"
                class="oe_structure"
                placeholder="A detailed, formatted description to promote your product on this page. Use '/' to discover more features."
              />
              <form
                t-if="product._is_add_to_cart_possible()"
                action="/shop/cart/update"
                method="POST"
              >
                <input
                  type="hidden"
                  name="csrf_token"
                  t-att-value="request.csrf_token()"
                  t-nocache="The csrf token must always be up to date."
                />
                <div class="js_product js_main_product mb-3">
                  <div>
                    <t t-call="website_sale.product_price" />
                    <small
                      t-if="combination_info['base_unit_price']"
                      class="ms-1 text-muted o_base_unit_price_wrapper d-none"
                      groups="website_sale.group_show_uom_price"
                    >
                      <t t-call="website_sale.base_unit_price" />
                    </small>
                  </div>
                  <t t-placeholder="select">
                    <input
                      type="hidden"
                      class="product_id"
                      name="product_id"
                      t-att-value="product_variant.id"
                    />
                    <input
                      type="hidden"
                      class="product_template_id"
                      name="product_template_id"
                      t-att-value="product.id"
                    />
                    <input
                      t-if="product.public_categ_ids.ids"
                      type="hidden"
                      class="product_category_id"
                      name="product_category_id"
                      t-att-value="product.public_categ_ids.ids[0]"
                    />
                    <t t-call="website_sale.variants">
                      <t t-set="ul_class" t-valuef="flex-column" />
                      <t t-set="parent_combination" t-value="None" />
                    </t>
                  </t>
                  <p
                    t-if="True"
                    class="css_not_available_msg alert alert-warning"
                  >
                    This combination does not exist.
                  </p>
                  <div
                    id="o_wsale_cta_wrapper"
                    class="d-flex flex-wrap align-items-center"
                  >
                    <t t-set="hasQuantities" t-value="false" />
                    <t t-set="hasBuyNow" t-value="false" />
                    <t
                      t-set="ctaSizeBig"
                      t-value="not hasQuantities or not hasBuyNow"
                    />

                    <div
                      id="add_to_cart_wrap"
                      t-attf-class="{{'d-none' if combination_info['prevent_zero_price_sale'] else 'd-inline-flex'}} align-items-center mb-2 me-4"
                    >
                      <a
                        data-animation-selector=".o_wsale_product_images"
                        role="button"
                        id="add_to_cart"
                        t-attf-class="btn btn-primary js_check_product a-submit flex-grow-1"
                        href="#"
                      >
                        <i class="fa fa-shopping-cart me-2" />
                        Add to cart
                      </a>
                    </div>
                    <div
                      id="add_to_whatsapp_cart_wrap"
                      t-attf-class="{{'d-none' if combination_info['prevent_zero_price_sale'] else 'd-inline-flex'}} align-items-center mb-2 me-auto"
                    >
                      <a
                        t-attf-class="btn btn-primary  flex-grow-1"
                        t-att-href="'https://api.whatsapp.com/send?phone=221785332828&amp;text=Je+suis+int%C3%A9ress%C3%A9+par+ce+produit%3A+' + product.name + '%0ALien+du+produit+dans+le+site+de+KD+MOBILIER%3A+' + base_url + product.website_url"
                        target="_blank"
                      >
                        <i class="fa fa-whatsapp me-2" />
                        Commender par WhatsApp
                      </a>
                    </div>

                    <div
                      id="product_option_block"
                      class="d-flex flex-wrap w-100"
                    />
                  </div>

                  <div
                    id="contact_us_wrapper"
                    t-attf-class="{{'d-flex' if combination_info['prevent_zero_price_sale'] else 'd-none'}} oe_structure oe_structure_solo #{_div_classes}"
                  >
                    <section
                      class="s_text_block"
                      data-snippet="s_text_block"
                      data-name="Text"
                    >
                      <div class="container">
                        <a
                          t-att-href="website.contact_us_button_url"
                          class="btn btn-primary btn_cta"
                          >Contact Us
                        </a>
                      </div>
                    </section>
                  </div>
                  <t
                    t-if="is_view_active('website_sale.product_tags')"
                    t-call="website_sale.product_tags"
                  >
                    <t
                      t-set="all_product_tags"
                      t-value="product_variant.all_product_tag_ids"
                    />
                  </t>
                </div>
              </form>
              <p t-elif="not product.active" class="alert alert-warning">
                This product is no longer available.
              </p>
              <p t-else="" class="alert alert-warning">
                This product has no valid combination.
              </p>
              <div id="product_attributes_simple">
                <t
                  t-set="single_value_attributes"
                  t-value="product.valid_product_template_attribute_line_ids._prepare_single_value_for_display()"
                />
                <table
                  t-attf-class="table table-sm text-muted {{'' if single_value_attributes else 'd-none'}}"
                >
                  <t t-foreach="single_value_attributes" t-as="attribute">
                    <tr>
                      <td>
                        <span t-field="attribute.name" />:
                        <t
                          t-foreach="single_value_attributes[attribute]"
                          t-as="ptal"
                        >
                          <span
                            t-field="ptal.product_template_value_ids._only_active().name"
                          /><t t-if="not ptal_last">, </t>
                        </t>
                      </td>
                    </tr>
                  </t>
                </table>
              </div>
              <t
                t-set="product_documents"
                t-value="product.sudo().product_document_ids.filtered(lambda doc: doc.shown_on_product_page)"
              />
              <div id="product_documents" class="my-2" t-if="product_documents">
                <h5>Documents</h5>
                <t t-foreach="product_documents" t-as="document_sudo">
                  <t
                    t-set="attachment_sudo"
                    t-value="document_sudo.ir_attachment_id"
                  />
                  <t
                    t-set="target"
                    t-value="attachment_sudo.type == 'url' and '_blank' or '_self'"
                  />
                  <t
                    t-set="icon"
                    t-value="attachment_sudo.type == 'url' and 'fa-link' or 'fa-download'"
                  />
                  <div>
                    <a
                      t-att-href="'/shop/' + slug(product) + '/document/' + str(document_sudo.id)"
                      t-att-target="target"
                    >
                      <i t-att-class="'fa ' + icon" />
                      <t t-out="attachment_sudo.name" />
                    </a>
                  </div>
                </t>
              </div>
              <div
                id="o_product_terms_and_share"
                class="d-flex justify-content-between flex-column flex-md-row align-items-md-end mb-3"
              ></div>
            </div>
          </div>
        </section>
        <div
          itemprop="description"
          t-field="product.website_description"
          class="oe_structure oe_empty mt16"
          id="product_full_description"
        />
        <div
          class="oe_structure oe_empty oe_structure_not_nearest mt16"
          id="oe_structure_website_sale_product_2"
          data-editor-message="DROP BUILDING BLOCKS HERE TO MAKE THEM AVAILABLE ACROSS ALL PRODUCTS"
        />
      </div>
    </xpath>
  </template>
  <!-- PRODUCT PAGE CUSTOM -->
  <template
    id="custom_product_share_buttons"
    inherit_id="website_sale.product_share_buttons"
    active="True"
    name="Share Buttons"
    priority="22"
  >
    <xpath
      expr="//div[@class='h4 mt-3 mb-0 d-flex justify-content-md-end flex-shrink-0']"
      position="replace"
    >
      <div
        class="h4 mt-3 mb-0 d-flex justify-content-md-end flex-shrink-0"
        contenteditable="false"
      >
        <t t-snippet-call="website.s_share">
          <t
            t-set="_exclude_share_links"
            t-value="['whatsapp','linkedin', 'facebook', 'pinterest', 'email', 'twitter']"
          />
          <t t-set="_no_title" t-value="True" />
          <t t-set="_classes" t-valuef="text-lg-end" />
          <t t-set="_link_classes" t-valuef="mx-1 my-0" />
        </t>
      </div>
    </xpath>
  </template>
  <!-- Add controller method to get categories -->
  <template
    id="kdmobilier_homepage_categories"
    inherit_id="kdmobilier_homepage"
  >
    <xpath expr="//section[hasclass('header-style-3')]" position="after">
      <t
        t-set="website_sale_categories"
        t-value="website.get_ecommerce_categories()"
      />
      <t t-set="category" t-value="false" />
      <t t-set="categories" t-value="website_sale_categories" />
      <t t-set="search" t-value="false" />
      <t t-set="search_categories_ids" t-value="[]" />

      <div class="ihbox-section-two">
        <div class="container-fluid p-0">
          <div
            class="swiper-slider"
            data-autoplay="false"
            data-loop="true"
            data-dots="false"
            data-arrows="false"
            data-columns="4"
            data-margin="30"
            data-effect="slide"
          >
            <div class="swiper-wrapper">
              <t t-foreach="categories" t-as="c">
                <article class="pbmit-miconheading-style-7 swiper-slide">
                  <a
                    t-att-href="'/shop/category/%s' % c.id"
                    class="pbmit-ihbox-style-7"
                  >
                    <div class="pbmit-ihbox-box">
                      <div class="pbmit-icon-wrapper d-flex align-items-center">
                        <div class="pbmit-ihbox-icon">
                          <div class="pbmit-ihbox-icon-wrapper">
                            <div
                              class="pbmit-icon-wrapper pbmit-icon-type-icon"
                            >
                              <div
                                t-if="c.image_128"
                                t-attf-style="background-image:url('data:image/png;base64,#{c.image_128}')"
                                class="o_image_40_cover oe_img_bg o_bg_img_center rounded-3"
                                t-att-alt="c.name"
                              />
                              <i
                                t-else=""
                                class="pbmit-xinterio-icon pbmit-xinterio-icon-house"
                              ></i>
                            </div>
                          </div>
                        </div>
                        <div class="pbmit-title-wrap">
                          <h2 class="pbmit-element-title" t-field="c.name" />
                        </div>
                      </div>
                    </div>
                    <!-- <div class="pbmit-ihbox-btn">
                                            <a class="pbmit-button-inner" t-att-href="'/shop/category/%s' % c.id">
                                                <span class="pbmit-button-wrapper">
                                                    <span class="pbmit-button-text">Read More</span>
                                                </span>
                                            </a>
                                        </div> -->
                  </a>
                </article>
              </t>
            </div>
          </div>
        </div>
      </div>
    </xpath>
  </template>
  <!-- Add controller method to get categories -->

  <!-- Remove navbar pills -->
  <template
    id="remove_navbar_pills"
    inherit_id="website.navbar_nav"
    name="Remove Navbar Pills"
    priority="99"
  >
    <xpath expr="//ul[@id='top_menu']" position="attributes">
      <attribute name="t-attf-class" remove="nav-pills" separator=" " />
    </xpath>
  </template>
  <!-- Header 1 KD mobilier -->
  <!-- <template id="template_kdmobilier_header_1" inherit_id="website.layout" name="Template KD mobilier Header 1">

    </template> -->
</odoo>
